{{/*
  sectionId: Optional argument to override the default HTML id for this section. If not provided, the default id is used. */}}
{{ $sectionId := "showcase" }}
{{ with .Get "sectionId" }}
{{ $sectionId = . }}
{{ end }}

<section {{if $sectionId}} id="{{ $sectionId }}" {{end}} class="rad-showcase rad-showcase--index rad-animation-group rad-fade-down">
    <div id="main-content">

        {{- $contextType := printf "%T" . -}}
        {{- $isShortcode := (eq $contextType "*hugolib.ShortcodeWithPage") -}}
        {{- $inner := (.Scratch.Get "Inner") -}}



        {{/* ---------------------------------------------------------------------------
         INTRO TITLE / DESCRIPTION / BUTTON
         --------------------------------------------------------------------------- */}}
        {{- /* Intro title/description */}}
        {{- $showcaseTitle := "" -}}
        {{- $showcaseSubtitle := "" -}}
        {{- $showcaseDescription := "" -}}
        {{- $buttonURL := "" -}}
        {{- $buttonIcon := "" -}}
        {{- $buttonText := "" -}}
        {{- $imgSrc := "" -}}
        {{- $imgWidth := 0 -}}
        {{- $imgHeight := 0 -}}
        {{- $imgScale := 0.5 -}}
        {{- $socialLinks := "" -}}
        {{- $carouselEnabled := false -}}
        {{- $carouselImages := "" -}}
        {{- $carouselInterval := 5000 -}}

        {{- if $isShortcode }}
        {{/* Shortcode params */}}
        {{- $showcaseTitle = .Get "title" | default ( i18n "showcase_title" ) -}}
        {{- $showcaseSubtitle = .Get "subtitle" | default ( i18n "showcase_subtitle" ) -}}
        {{- $showcaseDescription = .Get "description" | default ( i18n "showcase_description" ) | safeHTML -}}
        {{- $buttonURL = .Get "button_url" | default .Site.Data.homepage.showcase.button.URL -}}
        {{- $buttonIcon = .Get "button_icon" | default .Site.Data.homepage.showcase.button.icon -}}
        {{- $buttonText = .Get "button_text" | default false -}}
        {{- $imgSrc = .Get "imgSrc" | default .Site.Data.homepage.showcase.image.src -}}
        {{- $imgWidth = .Get "imgWidth" | default .Site.Data.homepage.showcase.image.width -}}
        {{- $imgHeight = .Get "imgHeight" | default .Site.Data.homepage.showcase.image.height -}}
        {{- $imgScale = .Get "imgScale" | default .Site.Data.homepage.showcase.image.scale -}}
        {{- $socialLinks = .Get "social_links" -}}
        {{- $carouselEnabled = .Get "carouselEnabled" | default false -}}
        {{- $carouselImages = split (.Get "carouselImages" | default "") "," -}}
        {{- $carouselInterval = .Get "carouselInterval" | default 5000 -}}
        {{ else }}
        {{/* Fallback site or i18n */}}
        {{- $showcaseTitle = i18n "showcase_title" -}}
        {{- $showcaseSubtitle = i18n "showcase_subtitle" -}}
        {{- $showcaseDescription = i18n "showcase_description" | safeHTML -}}
        {{- $buttonURL = .Site.Data.homepage.showcase.button.URL -}}
        {{- $buttonIcon = .Site.Data.homepage.showcase.button.icon -}}
        {{- $buttonText = i18n "showcase_button" -}}
        {{- $imgSrc = .Site.Data.homepage.showcase.image.src -}}
        {{- $imgWidth = .Site.Data.homepage.showcase.image.width -}}
        {{- $imgHeight = .Site.Data.homepage.showcase.image.height -}}
        {{- $imgScale = .Site.Data.homepage.showcase.image.scale -}}
        {{- $socialLinks = .Site.Data.homepage.showcase.socialLinks -}}
        {{ end }}

        <div class="showcase-section row flex-column-reverse flex-md-row rad-fade-down rad-waiting rad-animate">
            <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
                <h1 class="display-1">
                    {{ $showcaseTitle }}
                </h1>
                <h2 class="display-5">
                    <span>{{ $showcaseSubtitle | safeHTML }}</span>
                </h2>
                <div class="lead">
                    {{ $showcaseDescription }}
                </div>
                {{ if $buttonText }}
                <a href="{{ $buttonURL }}"
                   class="btn btn-primary">
                    <i class="{{ $buttonIcon }}"></i>
                    {{ $buttonText }}
                </a>
                {{ end }}
            </div>
            <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 profile-image">
                {{ if $carouselEnabled }}
                <!-- Carousel Section -->
                <div id="showcaseCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="{{ $carouselInterval }}">
                    <div class="carousel-indicators">
                        {{ range $index, $image := $carouselImages }}
                        <button type="button" data-bs-target="#showcaseCarousel" data-bs-slide-to="{{ $index }}"
                                {{ if eq $index 0 }} class="active" aria-current="true" {{ end }}
                                aria-label="Slide {{ add $index 1 }}"></button>
                        {{ end }}
                    </div>
                    <div class="carousel-inner">
                        {{ range $index, $image := $carouselImages }}
                        {{ $trimmedImage := trim $image " " }}
                        <div class="carousel-item {{ if eq $index 0 }}active{{ end }}">
                            <img src="{{ $trimmedImage | absURL }}" class="d-block w-100 lozad" alt="展示图片 {{ add $index 1 }}"
                                 data-loaded="false" loading="lazy">
                        </div>
                        {{ end }}
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#showcaseCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">上一张</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#showcaseCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">下一张</span>
                    </button>
                </div>
                <style>
                    .profile-image .carousel {
                        max-width: 100%;
                        height: auto;
                    }

                    .profile-image .carousel-inner {
                        border-radius: 8px;
                        overflow: hidden;
                    }

                    .profile-image .carousel-item img {
                        width: 100%;
                        height: auto;
                        object-fit: cover;
                    }
                </style>
                {{ else }}
                {{ partial "lazypicture" (dict "src" $imgSrc "width" $imgWidth "height" $imgHeight "scale" $imgScale "class" "")}}
                {{ end }}
            </div>

            {{- if $inner }}
            <div class="col-12 inner-content">
                {{ $inner }}
            </div>
            {{ end }}

        </div>

        <div class="row platform-links">
            <div class="col-12">
                {{- if $socialLinks -}}
                {{ range $socialLinks }}
                <a href="{{ .URL | absURL }}" target="_blank" rel="noopener noreferrer" aria-label="{{ .icon }}">
                    <i class="icon-{{ .icon }}"></i>
                </a>
                {{ end }}
                {{- end -}}
            </div>
        </div>
    </div>

</section>