{{/*
  sectionId: Optional argument to override the default HTML id for this section. If not provided, the default id is used. */}}
{{ $sectionId := "project-list-shortcode" }}
{{ with .Get "sectionId" }}
  {{ $sectionId = . }}
{{ end }}

{{ $padding := .Get "padding" }}
{{ $title := .Get "title" | default "" }}
{{ $containerClass := "" }}
{{ if eq $padding "true" }}
    {{ $containerClass = "container" }}
{{ end }}

<section {{if $sectionId}} id="{{ $sectionId }}"{{end}} class="section-project section section--border-bottom rad-animation-group flex-grow-1 {{ $containerClass }}">
    <div class="row flex-column-reverse flex-md-row rad-fade-down">
        <div class="project-list col-12 mt-5 mt-sm-0">
            {{ if $title }}
            <h2 class="section__title mb-4">{{ $title }}</h2>
            {{ end }}
            
            {{ $xp := (where .Site.RegularPages.ByDate "Type" "project") }}

            {{ $xpCount := len $xp }}

            {{ range $index, $element := first $xpCount (sort $xp "Date" "desc") }}
            <div class="project row">
                <div class="project__header col-12 col-md-3 d-flex align-items-start">
                    {{ $img := resources.Get .Params.companyLogo }}
                    {{ with $img }}
                    {{ $imgWebp := $img.Resize (printf "%dx%d webp q75 Lanczos picture" $img.Width $img.Height) }}
                    <img src="{{ $imgWebp.RelPermalink }}" alt="{{ .Params.company }} logo"
                        class="project__company-logo" loading="lazy">
                    {{ end }}
                    <div class="project__meta">
                        <div class="project__date">{{ .Params.duration }}</div>
                        <div class="project__title">{{ .Params.jobTitle }}</div>
                        <div class="project__company">{{ .Params.company }} <span class="project__location">
                                {{ .Params.location }}</span></div>
                    </div>
                </div>
                <div class="project__description d-print-block col-12 col-md-9 mt-3 mt-md-0">
                    <h1>{{ .Params.title }}</h1>
                    {{ .Content | safeHTML }}
                </div>
            </div>
            {{ if ne $index (sub $xpCount 1) }}
            <!-- Separator between projects for mobile -->
            <hr class="d-block d-md-none my-4">
            {{ end }}
            {{ end }}
        </div>
    </div>
</section>